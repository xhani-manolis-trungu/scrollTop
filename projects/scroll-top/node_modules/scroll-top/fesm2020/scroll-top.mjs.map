{"version":3,"file":"scroll-top.mjs","sources":["../../../projects/scroll-top/src/lib/scroll-top.service.ts","../../../projects/scroll-top/src/lib/scroll-top.directive.ts","../../../projects/scroll-top/src/lib/scroll-top.component.ts","../../../projects/scroll-top/src/lib/scroll-top.module.ts","../../../projects/scroll-top/src/public-api.ts","../../../projects/scroll-top/src/scroll-top.ts"],"sourcesContent":["import { Injectable, isDevMode } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ScrollTopService {\n  isDevMode = isDevMode();\n  isWindow = typeof window !== 'undefined';\n  _init = false;\n  private _elementToScroll!: HTMLElement | null;\n  private _host: any; // scrolling window by default or element if [elementId] is given\n  private lastY = 0;\n  private ticking = false;\n\n  get currentPositionY(): number {\n    return this._elementToScroll ? this._elementToScroll.scrollTop : window.pageYOffset;\n  }\n  get info(): number { return Math.ceil(this.lastY); }\n\n  setDevMode() { this.isDevMode = true; }\n  log = (s?: any, ...optional: any[]) => s && this.isDevMode && console.log(s, optional);\n\n  constructor() { }\n\n  init(elementId: string) {\n    if (this.isWindow) {\n      this.destroy();\n\n      this._elementToScroll = null;\n      if (elementId) {\n        this._elementToScroll = document.querySelector(`#${elementId}`) as HTMLElement;\n      }\n\n      this._host = this._elementToScroll || window;\n      this._host.addEventListener('scroll', this.handleScroll);\n\n      this.log(`'NgScrolltopService' to use ${this._elementToScroll ? 'element' : 'window'}`, elementId || '');\n    }\n\n    this._init = true;\n  }\n\n  destroy() {\n    this.isWindow && this._host && this._host.removeEventListener('scroll', this.handleScroll);\n  }\n\n  scrollABit(newY: number) {\n    if (this._elementToScroll) {\n      this._elementToScroll.scrollTop = newY;\n    } else {\n      window.scroll(0, newY);\n    }\n  }\n\n  private handleScroll = () => {\n    if (!this.ticking) {\n      window.requestAnimationFrame(() => {\n        this.updateLastY()\n        this.ticking = false\n      })\n      this.ticking = true\n    }\n  }\n\n  private updateLastY() {\n    if (!this._init) return;\n\n    const newY = this.currentPositionY\n    if (newY !== this.lastY) {\n      this.lastY = newY;\n    }\n  }\n}\n","import { Directive, HostListener, Input, NgZone } from '@angular/core';\r\nimport { ScrollTopService } from './scroll-top.service';\r\n\r\nconst DURATION = 1000;\r\n\r\n@Directive({\r\n  selector: '[blScrolltop]'\r\n})\r\nexport class ScrollTopDirective {\r\n  startTime!: number | null;\r\n  startTop!: number;\r\n  progress: number = 0;\r\n\r\n  constructor(public service: ScrollTopService,\r\n    private ngZone: NgZone) {\r\n    this.scrollABit = this.scrollABit.bind(this);\r\n  }\r\n\r\n  @Input('targetElement') targetElement!: string;\r\n\r\n  @HostListener('click', ['$event'])\r\n  onclick($event: any) {\r\n    this.startTop = this.service.currentPositionY;\r\n    this.startTime = null;\r\n\r\n    if (this.targetElementExists($event, this.targetElement)) {\r\n      this.ngZone.runOutsideAngular(() => { window.requestAnimationFrame(this.scrollABit); });\r\n    }\r\n\r\n    this.service.log('NgScrolltopDirective click');\r\n  }\r\n\r\n  private targetElementExists($event: any, selector: string): boolean {\r\n    let found = false;\r\n\r\n    if ($event?.target.matches(`#${selector}, #${selector} > *`)) {\r\n      found = true;\r\n    }\r\n    return found;\r\n  }\r\n\r\n  easing = (x: number) => {\r\n    'use strict';\r\n\r\n    if (x < 0.5) {\r\n      return Math.pow(x * 2, 2) / 2;\r\n    }\r\n    return 1 - Math.pow((1 - x) * 2, 2) / 2;\r\n  }\r\n\r\n  scrollABit(timestamp: number) {\r\n    if (!this.startTime) {\r\n      this.startTime = timestamp;\r\n    }\r\n\r\n    this.progress = timestamp - this.startTime;\r\n    const percent = (this.progress >= DURATION ? 1 : this.easing(this.progress / DURATION));\r\n    const newY = this.startTop - Math.ceil(this.startTop * percent);\r\n\r\n    this.service.scrollABit(newY);\r\n\r\n    if (percent < 1) {\r\n      this.ngZone.runOutsideAngular(() => { window.requestAnimationFrame(this.scrollABit); });\r\n    }\r\n  }\r\n}\r\n","import { Component, Input, OnDestroy, OnInit } from '@angular/core';\nimport { ScrollTopDirective } from './scroll-top.directive';\nimport { ScrollTopService } from './scroll-top.service';\n\n@Component({\n  selector: 'lib-scroll-top',\n  template: `\n    <div class=\"scroll-top\" ></div>\n  `,\n  providers: [ScrollTopDirective]\n})\nexport class ScrollTopComponent implements OnInit, OnDestroy {\n  private _elementId!: string;\n\n  @Input()\n  set elementId(value: string) {\n    this._elementId = value;\n    this.service.init(value);\n  }\n\n  constructor(private service: ScrollTopService) { }\n\n  ngOnInit(): void {\n    this.service.init(this._elementId);\n  }\n\n  ngOnDestroy() {\n    this.service.destroy();\n  }\n\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { ScrollTopComponent } from './scroll-top.component';\nimport { ScrollTopDirective } from './scroll-top.directive';\n\n@NgModule({\n  declarations: [\n    ScrollTopComponent,\n    ScrollTopDirective\n  ],\n  imports: [\n    CommonModule\n  ],\n  exports: [\n    ScrollTopComponent,\n    ScrollTopDirective\n  ]\n})\nexport class ScrollTopModule { }\n","/*\n * Public API Surface of scroll-top\n */\n\nexport * from './lib/scroll-top.service';\nexport * from './lib/scroll-top.component';\nexport * from './lib/scroll-top.directive';\nexport * from './lib/scroll-top.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1.ScrollTopService"],"mappings":"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"}